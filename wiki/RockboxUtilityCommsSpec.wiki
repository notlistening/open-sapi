#summary The Communication Protocol for Rockbox Utility Open Sapi Server
#labels Phase-Implementation
<wiki:toc max_depth="2" />

=Communication Specifications=

The server expects data to arrive in UTF-8 format from the client.

The client must call a single readyServer command before issuing any further commands to the server. This has been implemented so that if the client is responsible for starting the server a call for sererReady can be main repeatedly until a response is received or startup fails. This is implemented in the client where is attempts five startups.

All settings can be send in a group to the server or seperatly

The speakMe command must be spent on its own as the last command to start synthesis on the server using the current settings
   
=Protocol=

Command   : readyServer <br>
Arguments : None <br>
Returns   : Status No : Desc (204:Ready) <br>

Command   : exitServer <br>
Arguments : None <br>
Returns   : Status No : Desc ( : ) <br>

Command   : getFormat <br>
Arguments : None <br>
Returns   : ID:Descr (1:SPSF_8kHz8BitMono:2:SPSF_8kHz8BitStereo) <br>

Command   : setFormat <br>
Arguments : Format ID <br>
Returns   : None <br>

Command   : outFile <br>
Arguments : Filename (/tmp/filename , c:\temp\filename) <br>
Returns   : None <br>
Comment   : This is the full filename for where the file should be stored <br>

Command   : getVol <br>
Arguments : None <br>
Returns   : Volume (0 - 100) <br>

Command   : setVol <br>
Arguments : Volume (0 - 100) <br>
Returns   : None <br>

Command   : setPitch <br>
Arguments : Pitch (-10 - +10) <br>
Returns   : None <br>

Command   : getEngine <br>
Arguments : None <br>
Returns   : ID : Name (1:Microsoft Mary) <br>

Command   : setEngine <br>
Arguments : ID <br>
Returns   : None <br>

Command   : getRate <br>
Arguments : None <br>
Returns   : Rate <br>

Command   : setRate <br>
Arguments : Rate (-10 - 10)<br>
Returns   : None <br>

Command   : speakMe <br>
Arguments : Text For Synth <br>
Returns   : Status : Desc (205 : Synthesis OK) <br>

Command   : speechFlag <br>
Arguments : Value (See extended notes at bottom) <br>
Returns   : None <br>

Command   : testMe <br>
Arguments : None <br>
Returns   : None <br>

Command   : Verbose <br>
Arguments : None <br>
Returns   : None <br>
----
=Extended Notes=

==Speech Flags==
See the SAPI documentation for further details. <br>
SVSFDefault = 0 <br>
SVSFlagsAsync = 1 <br>
SVSFPurgeBeforeSpeak = 2 <br>
SVSFIsFilename = 4 <br>
SVSFIsXML = 8 <br>
SVSFIsNotXML = 16 <br>
SVSFPersistXML = 32 <br>
SVSFNLPSpeakPunc = 64 <br>

==Wav format list==
0    SPSF_NoAssignedFormat <br>
1    SPSF_Text <br>
3    SPSF_NonStandardFormat <br>
4    SPSF_ExtendedAudioFormat  <br>
5    SPSF_8kHz8BitMono <br>
6    SPSF_8kHz8BitStereo <br>
7    SPSF_8kHz16BitMono <br>
8    SPSF_8kHz16BitStereo <br>
SPSF_11kHz8BitMono <br>
SPSF_11kHz8BitStereo <br>
SPSF_11kHz16BitMono <br>
SPSF_11kHz16BitStereo
SPSF_12kHz8BitMono
SPSF_12kHz8BitStereo
SPSF_12kHz16BitMono
SPSF_12kHz16BitStereo
SPSF_16kHz8BitMono
SPSF_16kHz8BitStereo
SPSF_16kHz16BitMono
SPSF_16kHz16BitStereo
SPSF_22kHz8BitMono
SPSF_22kHz8BitStereo
SPSF_22kHz16BitMono
SPSF_22kHz16BitStereo
SPSF_24kHz8BitMono
SPSF_24kHz8BitStereo
SPSF_24kHz16BitMono
SPSF_24kHz16BitStereo
SPSF_32kHz8BitMono
SPSF_32kHz8BitStereo
SPSF_32kHz16BitMono
SPSF_32kHz16BitStereo
SPSF_44kHz8BitMono
SPSF_44kHz8BitStereo
SPSF_44kHz16BitMono
SPSF_44kHz16BitStereo
SPSF_48kHz8BitMono
SPSF_48kHz8BitStereo
SPSF_48kHz16BitMono
SPSF_48kHz16BitStereo
SPSF_TrueSpeech_8kHz1BitMono
SPSF_CCITT_ALaw_8kHzMono
SPSF_CCITT_ALaw_8kHzStereo
SPSF_CCITT_ALaw_11kHzMono
SPSF_CCITT_ALaw_11kHzStereo
SPSF_CCITT_ALaw_22kHzMono
SPSF_CCITT_ALaw_22kHzStereo
SPSF_CCITT_ALaw_44kHzMono
SPSF_CCITT_ALaw_44kHzStereo
SPSF_CCITT_uLaw_8kHzMono
SPSF_CCITT_uLaw_8kHzStereo
SPSF_CCITT_uLaw_11kHzMono
SPSF_CCITT_uLaw_11kHzStereo
SPSF_CCITT_uLaw_22kHzMono
SPSF_CCITT_uLaw_22kHzStereo
SPSF_CCITT_uLaw_44kHzMono
SPSF_CCITT_uLaw_44kHzStereo
SPSF_ADPCM_8kHzMono
SPSF_ADPCM_8kHzStereo
SPSF_ADPCM_11kHzMono
SPSF_ADPCM_11kHzStereo
SPSF_ADPCM_22kHzMono
SPSF_ADPCM_22kHzStereo
SPSF_ADPCM_44kHzMono
SPSF_ADPCM_44kHzStereo
SPSF_GSM610_8kHzMono
SPSF_GSM610_11kHzMono
SPSF_GSM610_22kHzMono
SPSF_GSM610_44kHzMono